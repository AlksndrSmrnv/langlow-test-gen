<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¢–µ—Å—Ç–æ–≤</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <div class="header">
            <div>
                <h1>üß™ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¢–µ—Å—Ç–æ–≤</h1>
                <p class="subtitle">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∏ —á–µ–∫-–ª–∏—Å—Ç–æ–≤</p>
            </div>
            <button class="btn btn-icon" id="settingsBtn" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è">‚öôÔ∏è</button>
        </div>

        <div class="main-content">
            <div class="section" data-section="features">
                <div class="section-title"><span>üìÑ</span> –°—Ç—Ä–∞–Ω–∏—Ü—ã —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Ñ–∏—á–∏</div>
                <div class="section-content">
                    <div id="featureList">
                        <div class="feature-item">
                            <input type="url" class="feature-input" placeholder="https://confl.ru/pageid=1234" required>
                            <button class="btn btn-remove" style="display: none;">‚úï</button>
                        </div>
                    </div>
                    <button class="btn btn-add" id="addFeatureBtn"><span>+</span> –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</button>
                </div>
            </div>

            <div class="section" data-section="checklist">
                <div class="section-title"><span>‚úì</span> –ß–µ–∫-–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫–∞</div>
                <div class="section-content">
                    <div class="input-group">
                        <input type="url" id="checklistUrl" placeholder="https://confl.ru/pageid=12346" required>
                        <p class="info-text">–°—Å—ã–ª–∫–∞ –Ω–∞ —á–µ–∫-–ª–∏—Å—Ç –≤ Confluence</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div class="modal" id="settingsModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Langflow</h2>
                    <button class="btn btn-icon close-btn" id="closeSettingsBtn">‚úï</button>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <label for="langflowUrl">URL Langflow –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤</label>
                        <input type="url" id="langflowUrl"
                            placeholder="http://localhost:7860/api/v1/run/GENERATION_FLOW_ID">
                        <p class="info-text">Endpoint –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤</p>
                    </div>
                    <div class="input-group">
                        <label for="agentChatLangflowUrl">URL Langflow –¥–ª—è —á–∞—Ç–∞ —Å –∞–≥–µ–Ω—Ç–æ–º</label>
                        <input type="url" id="agentChatLangflowUrl"
                            placeholder="http://localhost:7860/api/v1/run/AGENT_FLOW_ID">
                        <p class="info-text">Endpoint –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ —á–∞—Ç</p>
                    </div>
                    <div class="input-group">
                        <label for="jiraLangflowUrl">URL Langflow –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ JIRA</label>
                        <input type="url" id="jiraLangflowUrl"
                            placeholder="http://localhost:7860/api/v1/run/JIRA_FLOW_ID">
                        <p class="info-text">Endpoint –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤ –≤ JIRA</p>
                    </div>
                    <div class="input-group">
                        <label for="apiKey">API Key</label>
                        <div class="token-input-wrapper">
                            <input type="password" id="apiKey" placeholder="–í–∞—à API –∫–ª—é—á">
                            <button type="button" class="btn-toggle-token" data-target="apiKey" title="–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å">üëÅÔ∏è</button>
                        </div>
                        <p class="info-text">–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</p>
                    </div>
                    <div class="input-group">
                        <label for="apiFormat">–§–æ—Ä–º–∞—Ç API</label>
                        <select id="apiFormat">
                            <option value="standard">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π (input_value)</option>
                            <option value="inputs">–° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º inputs</option>
                            <option value="message">–° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º message</option>
                        </select>
                        <p class="info-text">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–µ—Ä—Å–∏–∏ Langflow</p>
                    </div>
                    <div class="input-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="mockModeEnabled" style="width: auto; cursor: pointer;">
                            <span>üé≠ –†–µ–∂–∏–º –∑–∞–≥–ª—É—à–µ–∫ (Mock Mode)</span>
                        </label>
                        <p class="info-text">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ UI –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Langflow. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ mock.js</p>
                    </div>
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid var(--border);">
                    <h3 style="margin-bottom: 15px; font-size: 1em; color: var(--text-secondary);">üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Jira D</h3>
                    <div class="input-group">
                        <label for="jiraConnectionUrl">URL Jira</label>
                        <input type="url" id="jiraConnectionUrl" placeholder="https://your-domain.atlassian.net">
                        <p class="info-text">–ë–∞–∑–æ–≤—ã–π URL –≤–∞—à–µ–≥–æ Jira</p>
                    </div>
                    <div class="input-group">
                        <label for="jiraConnectionToken">–¢–æ–∫–µ–Ω Jira</label>
                        <div class="token-input-wrapper">
                            <input type="password" id="jiraConnectionToken" placeholder="–í–∞—à API —Ç–æ–∫–µ–Ω Jira">
                            <button type="button" class="btn-toggle-token" data-target="jiraConnectionToken" title="–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å">üëÅÔ∏è</button>
                        </div>
                        <p class="info-text">API —Ç–æ–∫–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Jira</p>
                    </div>
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid var(--border);">
                    <h3 style="margin-bottom: 15px; font-size: 1em; color: var(--text-secondary);">üìö –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Confluence</h3>
                    <div class="input-group">
                        <label for="confluenceToken">–¢–æ–∫–µ–Ω Confluence</label>
                        <div class="token-input-wrapper">
                            <input type="password" id="confluenceToken" placeholder="–í–∞—à API —Ç–æ–∫–µ–Ω Confluence">
                            <button type="button" class="btn-toggle-token" data-target="confluenceToken" title="–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å">üëÅÔ∏è</button>
                        </div>
                        <p class="info-text">API —Ç–æ–∫–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Confluence</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="modal-footer-left">
                        <button class="btn btn-outline" id="exportSettingsBtn">üì§ –≠–∫—Å–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫</button>
                        <button class="btn btn-outline" id="importSettingsBtn">üì• –ò–º–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫</button>
                        <input type="file" id="importSettingsFile" accept=".json" style="display: none;">
                    </div>
                    <button class="btn btn-primary" id="saveSettingsBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </div>
            </div>
        </div>

        <button class="btn btn-primary btn-generate" id="generateBtn">üöÄ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã</button>

        <!-- Loader -->
        <div class="loader" id="loader">
            <div class="spinner"></div>
            <div class="loader-text" id="loaderText">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏...</div>
            <div class="loader-substatus" id="loaderSubstatus"></div>
        </div>

        <!-- Result Section -->
        <div class="result-section" id="resultSection">
            <!-- Agent Chat -->
            <div class="agent-chat" id="agentChat">
                <div class="agent-chat-header">
                    <div class="agent-chat-header-icon">ü§ñ</div>
                    <div>
                        <h3>–ß–∞—Ç —Å AI –∞–≥–µ–Ω—Ç–æ–º</h3>
                        <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Å—Ç —á–µ–∫–±–æ–∫—Å–æ–º –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</p>
                    </div>
                </div>
                <div class="agent-chat-body">
                    <div class="agent-chat-context" id="agentChatContext">
                        <div class="agent-chat-context-header">
                            <span>üìã</span>
                            <span class="agent-chat-context-title">–í—ã–±—Ä–∞–Ω —Ç–µ—Å—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</span>
                        </div>
                        <div class="agent-chat-context-test" id="agentChatContextTest"></div>
                    </div>
                    <div class="agent-chat-warning" id="agentChatWarning">
                        <span style="color: var(--error);">‚ö†Ô∏è</span>
                        <span class="agent-chat-warning-text">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ç–µ—Å—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</span>
                    </div>
                    <div class="agent-chat-messages" id="agentChatMessages"></div>
                    <div class="agent-chat-loader" id="agentChatLoader">
                        <div class="agent-chat-loader-spinner"></div>
                        <span>–ê–≥–µ–Ω—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–∞—à –∑–∞–ø—Ä–æ—Å...</span>
                    </div>
                </div>
                <div class="agent-chat-input">
                    <div class="agent-chat-input-wrapper">
                        <textarea class="agent-chat-textarea" id="agentChatInput"
                            placeholder="–ù–∞–ø–∏—à–∏—Ç–µ, —á—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ —Ç–µ—Å—Ç–µ..."></textarea>
                        <button class="btn btn-primary" id="agentChatSendBtn" disabled>
                            <span>üì§</span>
                            <span>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</span>
                        </button>
                    </div>
                </div>
            </div>

            <div id="testsSection" style="display: none;">
                <div class="section-header">
                    <div class="section-header-title">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã</div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <button class="btn btn-outline" id="toggleAllBtn">üìÇ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ</button>
                        <div class="badge badge-primary" id="testsCount">0 —Ç–µ—Å—Ç–æ–≤</div>
                    </div>
                </div>
                <div class="tests-container" id="testsContainer"></div>

                <!-- JIRA Export -->
                <div class="jira-section" id="jiraSection">
                    <div class="section-title">üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤ –≤ Jira D Zephyr</div>
                    <div
                        style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <div class="badge badge-success" id="selectedCount">–í—ã–±—Ä–∞–Ω–æ: 0 —Ç–µ—Å—Ç–æ–≤</div>
                        <button class="btn btn-outline" id="selectAllBtn" style="color: var(--success);">–í—ã–±—Ä–∞—Ç—å
                            –≤—Å–µ</button>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div class="input-group">
                            <label for="jiraProjectKey">Project Key</label>
                            <input type="text" id="jiraProjectKey" placeholder="PROJ" required>
                            <p class="info-text">–ö–ª—é—á –ø—Ä–æ–µ–∫—Ç–∞ –≤ JIRA</p>
                        </div>
                        <div class="input-group">
                            <label for="jiraFolderName">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏</label>
                            <input type="text" id="jiraFolderName" placeholder="Sprint 1 / Feature Tests" required>
                            <p class="info-text">–ü—É—Ç—å –∫ –ø–∞–ø–∫–µ –≤ JIRA Zephyr</p>
                        </div>
                        <div class="input-group">
                            <label for="jiraConfigurationElement">–ê–°(–ö–≠)</label>
                            <input type="text" id="jiraConfigurationElement" placeholder="–ê–°(–ö–≠)">
                            <p class="info-text">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–ö—Ä–∏—Ç–µ—Ä–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)</p>
                        </div>
                        <div class="input-group">
                            <label for="jiraTestType">–í–∏–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</label>
                            <input type="text" id="jiraTestType" placeholder="–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ">
                            <p class="info-text">–¢–∏–ø —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</p>
                        </div>
                    </div>

                    <button class="btn btn-success" id="btnSendJira" style="margin-top: 16px;">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ
                        —Ç–µ—Å—Ç—ã –≤ Jira D</button>
                    <div class="jira-status" id="jiraStatus"></div>
                </div>
            </div>

            <div id="additionalChecksSection" style="display: none;">
                <div class="additional-checks">
                    <div class="additional-checks-title">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏</div>
                    <div id="additionalChecksContent"></div>
                </div>
            </div>

            <div id="plainTextSection" style="display: none;">
                <div class="result-title">
                    <div class="result-title-text">
                        <span class="success-icon">‚úì</span>
                        <span>–†–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</span>
                    </div>
                    <button class="btn btn-outline" id="copyPlainTextBtn">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
                <div class="plain-text-content" id="plainTextContent"></div>
            </div>

            <div id="errorSection" style="display: none;">
                <div class="result-title">
                    <div class="result-title-text">
                        <span class="error-icon">‚úï</span>
                        <span>–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</span>
                    </div>
                </div>
                <div class="error-content" id="errorContent"></div>
            </div>
        </div>
    </div>

    <div class="autosave" id="autosave"><span>‚úì</span><span>–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã</span></div>

    <script src="mock.js"></script>
    <script src="app.js"></script>
</body>

</html>
